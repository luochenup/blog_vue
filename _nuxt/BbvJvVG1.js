import{T as x,Q as D,U as E,V as A,v as V,w as B,c as F,h as I}from"./raXDgERY.js";import{_ as S}from"./xFg6T9EQ.js";import{u as $,q}from"./CS7__6sN.js";import{j as z,l as y,C as N,ak as R,c as H,R as v,U as m,_ as T,Y as g,F as b,L as d,aa as _,$ as P,a0 as W,a4 as j,X as O,a9 as Q}from"./Dkj_qHQx.js";const U=({delay:o},e)=>{let t,n=!0;const s=(...c)=>{n?(clearTimeout(t),t=setTimeout(()=>{n&&e(...c),t=void 0},o)):e(...c)};return s.isPending=()=>t!==void 0,s.cancel=()=>{n=!1},s.flush=(...c)=>e(...c),s},Y=({interval:o},e)=>{let t=!0,n;const s=(...c)=>{t&&(e(...c),t=!1,n=setTimeout(()=>{t=!0,n=void 0},o))};return s.isThrottled=()=>n!==void 0,s},Z=o=>Y({interval:20},o),L=o=>U({delay:20},o);function M(o){const e=Z(o),t=L(o);return()=>{e(),t()}}function X(o){const e=z(null),t=(p,a=[])=>(p.forEach(l=>{const r=document.getElementById(l.id);r&&a.push({id:l.id,offsetTop:r.offsetTop}),l.children&&t(l.children,a)}),a),n=x(()=>y(o),()=>t(y(o)).reverse()),s=()=>{const p=Number.parseFloat(getComputedStyle(document.documentElement).getPropertyValue("scroll-margin-top")),a=window.scrollY+(p||64),l=n.value.find(i=>i.offsetTop<=a);e.value=l?.id||null;const r=document.querySelector("#z-aside"),h=document.querySelector(`#z-aside a[href="#${e.value}"]`);r?.scroll({top:h?.offsetTop||0})};D("scroll",M(()=>s()),{passive:!0});const{height:c}=E(document?.body);return A(c,n.trigger),{activeTocItem:e}}const G={href:"#main-content","aria-label":"返回开头"},J={href:"#twikoo","aria-label":"评论区"},K=["href","title"],ee={key:1,class:"no-toc"},te=N({__name:"Toc",async setup(o){let e,t;const n=V(),[s,c]=B(),{data:p}=([e,t]=R(()=>$(()=>`toc-${n.path}`,()=>q("content").path(n.path).first(),"$QfZHduD163")),e=await e,t(),e),a=H(()=>p.value?.body?.toc),{activeTocItem:l}=X(()=>a.value?.links??[]);function r(h,i){return h.id===i?!0:h.children?.some(f=>r(f,i))??!1}return(h,i)=>{const f=F,k=S;return m(),v(k,{"content-class":"widget-body"},{title:T(()=>[i[0]||(i[0]=_("span",{class:"title"},"文章目录",-1)),_("a",G,[g(f,{name:"ph:arrow-circle-up-bold"})]),_("a",J,[g(f,{name:"ph:chat-circle-text-bold"})])]),default:T(()=>[g(d(s),null,{default:T(({tocItem:C})=>[_("ol",null,[(m(!0),b(P,null,W(C,(u,w)=>(m(),b("li",{key:w,class:j({"has-active":r(u,d(l)),active:u.id===d(l)})},[_("a",{href:`#${u?.id}`,title:u.text},Q(u.text),9,K),u.children?(m(),v(d(c),{key:0,"toc-item":u.children},null,8,["toc-item"])):O("",!0)],2))),128))])]),_:1}),d(a)?.links.length?(m(),v(d(c),{key:0,"toc-item":d(a).links},null,8,["toc-item"])):(m(),b("p",ee," 暂无目录信息 "))]),_:1})}}}),ae=Object.assign(I(te,[["__scopeId","data-v-4e58124c"]]),{__name:"WidgetToc"});export{ae as default};
