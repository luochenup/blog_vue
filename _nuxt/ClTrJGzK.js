import{B as w}from"./raXDgERY.js";import{j as s,ar as m}from"./Dkj_qHQx.js";const D=()=>{const r=s(null),l=s(!1),a=s(null),t=s(null),p=w(),v="https://v2.alapi.cn/api/zaobao",b=p.public.zaobaoToken||"0hbyaty06lzwmdwdzynwqwljems0tx",y="https://images.weserv.nl/?url=",h=()=>{if(!t.value)return!1;const e=Date.now(),o=new Date,i=o.getFullYear(),c=String(o.getMonth()+1).padStart(2,"0"),u=String(o.getDate()).padStart(2,"0"),n=`${i}-${c}-${u}`,d=t.value.data?.datatime;return d&&d!==n?!1:e<t.value.expires},g=async()=>{if(h()&&t.value?.data){r.value=t.value.data;return}l.value=!0,a.value=null;try{const e=`${v}?token=${b}&format=image`,o=new Date,i=o.getFullYear(),c=String(o.getMonth()+1).padStart(2,"0"),u=String(o.getDate()).padStart(2,"0"),n=`${i}-${c}-${u}`,f={imageUrl:`${y}${encodeURIComponent(e)}&t=${n}`,originalImageUrl:e,datatime:n,title:`每日早报 - ${n}`,description:"每日精选热点新闻早报，60秒了解天下事",source:"每日早报",category:"综合"};r.value=f,t.value={data:f,timestamp:Date.now(),expires:Date.now()+600*1e3}}catch(e){console.error("获取早报数据失败:",e),e instanceof Error?e.message.includes("404")?a.value="早报数据暂不可用，请稍后重试":e.message.includes("Load failed")||e.message.includes("FetchError")?a.value="网络连接失败，请检查网络后刷新重试":e.message.includes("timeout")||e.message.includes("abort")?a.value="请求超时，请稍后重试":e.message.includes("CORS")?a.value="跨域访问被阻止，请稍后重试":a.value=`数据加载失败: ${e.message}`:a.value="早报数据加载失败，请刷新页面重试"}finally{l.value=!1}},$=()=>(t.value=null,g());return{zaobao:m(r),zaobaoLoading:m(l),zaobaoError:m(a),fetchZaobao:g,refreshZaobao:$}};export{D as u};
