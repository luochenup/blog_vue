import{k as S,l as q,m as E,o as G,c as I,h as U}from"./raXDgERY.js";import{u as V}from"./ClTrJGzK.js";import{C as P,j as b,D as Z,F as i,U as l,aa as t,Y as h,X as v,ag as $,a4 as m,L as e,a9 as n,$ as C,a0 as j}from"./Dkj_qHQx.js";const B={class:"mobile-only"},H={class:"test-page"},F={class:"page-header"},K={class:"header-content"},O={class:"page-title"},Q={class:"device-info"},X={class:"info-grid"},R={class:"info-item"},W={class:"info-item"},Y={class:"value"},J={key:0,class:"network-status"},tt={class:"info-grid"},st={class:"info-item"},et={class:"value"},ot={class:"info-item"},nt={class:"value"},at={class:"info-item"},it={class:"value"},lt={class:"info-item"},ct={class:"info-item"},rt={class:"value"},dt={class:"api-test"},ut={class:"test-controls"},pt=["disabled"],_t={key:0,class:"test-results"},vt={class:"result-header"},mt={class:"api-url"},ft={class:"result-details"},gt={class:"response-time"},bt={key:0,class:"error-message"},ht={class:"zaobao-test"},kt={class:"test-controls"},yt=["disabled"],wt={key:0,class:"zaobao-loading"},zt={key:1,class:"zaobao-content"},Ct={class:"zaobao-image"},Mt=["src","alt"],At={class:"zaobao-info"},Tt={class:"zaobao-meta"},xt={key:2,class:"zaobao-error"},Nt=P({__name:"test-mobile-network",setup(Dt){const M=S(),A=q();E({title:"移动端网络测试 - 早报接口测试",meta:[{name:"description",content:"测试移动端网络请求配置和早报接口连接"},{property:"og:image",content:M.author.avatar}]});const{zaobao:c,zaobaoLoading:f,zaobaoError:k,fetchZaobao:y,refreshZaobao:w,isMobile:g}=V(),d=b(null),u=b("unknown"),r=b([]);A.setAside(["weather"]);const z=()=>{if("connection"in navigator){const o=navigator.connection;d.value={effectiveType:o.effectiveType,downlink:o.downlink,rtt:o.rtt,saveData:o.saveData},o.effectiveType==="4g"&&o.downlink>10&&o.rtt<100?u.value="excellent":o.effectiveType==="4g"&&o.downlink>5&&o.rtt<200?u.value="good":o.effectiveType==="3g"&&o.downlink>2&&o.rtt<300?u.value="fair":u.value="poor"}},T=async o=>{const s=Date.now();try{const p=await $fetch(o,{timeout:15e3,headers:{"User-Agent":g.value?"Mozilla/5.0 (iPhone; CPU iPhone OS 14_7_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Mobile/15E148 Safari/604.1":"Mozilla/5.0 (compatible; Zaobao-Client/1.0)",Accept:"application/json, text/plain, */*","Accept-Language":"zh-CN,zh;q=0.9,en;q=0.8"}}),_=Date.now();r.value.push({api:o,status:"success",time:_-s})}catch(p){const _=Date.now();r.value.push({api:o,status:"failed",time:_-s,error:p instanceof Error?p.message:String(p)})}},x=async()=>{r.value=[];const o=["https://api.2xb.cn/zaob","http://dwz.2xb.cn/zaob","https://v2.alapi.cn/api/zaobao?token=0hbyaty06lzwmdwdzynwqwljems0tx&format=image"];for(const s of o)await T(s)};Z(()=>{z(),"connection"in navigator&&navigator.connection.addEventListener("change",z)});const N=o=>({excellent:"优秀",good:"良好",fair:"一般",poor:"较差",unknown:"未知"})[o]||o,D=o=>({"4g":"4G","3g":"3G","2g":"2G","slow-2g":"慢速2G"})[o]||o;return(o,s)=>{const p=G,_=I;return l(),i(C,null,[t("div",B,[h(p,{to:"/"})]),t("div",H,[t("div",F,[t("div",K,[t("h1",O,[h(_,{name:"ph:network-bold",class:"title-icon"}),s[3]||(s[3]=$(" 移动端网络测试 ",-1))]),s[4]||(s[4]=t("p",{class:"page-description"},"测试移动端网络请求配置和早报接口连接",-1))])]),t("div",Q,[s[7]||(s[7]=t("h2",null,"设备信息",-1)),t("div",X,[t("div",R,[s[5]||(s[5]=t("label",null,"设备类型:",-1)),t("span",{class:m(["value",e(g)?"mobile":"desktop"])},n(e(g)?"移动设备":"桌面设备"),3)]),t("div",W,[s[6]||(s[6]=t("label",null,"User-Agent:",-1)),t("span",Y,n(o.navigator?.userAgent||"未知"),1)])])]),e(d)?(l(),i("div",J,[s[13]||(s[13]=t("h2",null,"网络状态",-1)),t("div",tt,[t("div",st,[s[8]||(s[8]=t("label",null,"网络类型:",-1)),t("span",et,n(D(e(d).effectiveType)),1)]),t("div",ot,[s[9]||(s[9]=t("label",null,"下行速度:",-1)),t("span",nt,n(e(d).downlink)+" Mbps",1)]),t("div",at,[s[10]||(s[10]=t("label",null,"往返时间:",-1)),t("span",it,n(e(d).rtt)+" ms",1)]),t("div",lt,[s[11]||(s[11]=t("label",null,"网络质量:",-1)),t("span",{class:m(["value","quality",e(u)])},n(N(e(u))),3)]),t("div",ct,[s[12]||(s[12]=t("label",null,"省流模式:",-1)),t("span",rt,n(e(d).saveData?"开启":"关闭"),1)])])])):v("",!0),t("div",dt,[s[14]||(s[14]=t("h2",null,"API接口测试",-1)),t("div",ut,[t("button",{class:"test-btn",onClick:x,disabled:e(r).length>0}," 开始测试所有接口 ",8,pt),e(r).length>0?(l(),i("button",{key:0,class:"test-btn secondary",onClick:s[0]||(s[0]=a=>r.value=[])}," 清空结果 ")):v("",!0)]),e(r).length>0?(l(),i("div",_t,[(l(!0),i(C,null,j(e(r),(a,L)=>(l(),i("div",{key:L,class:m(["test-result",a.status])},[t("div",vt,[t("span",mt,n(a.api),1),t("span",{class:m(["status-badge",a.status])},n(a.status==="success"?"成功":"失败"),3)]),t("div",ft,[t("span",gt,"响应时间: "+n(a.time)+"ms",1),a.error?(l(),i("span",bt,"错误: "+n(a.error),1)):v("",!0)])],2))),128))])):v("",!0)]),t("div",ht,[s[16]||(s[16]=t("h2",null,"早报功能测试",-1)),t("div",kt,[t("button",{class:"test-btn",onClick:s[1]||(s[1]=(...a)=>e(y)&&e(y)(...a)),disabled:e(f)},n(e(f)?"获取中...":"获取早报"),9,yt),e(c)?(l(),i("button",{key:0,class:"test-btn secondary",onClick:s[2]||(s[2]=(...a)=>e(w)&&e(w)(...a))}," 刷新早报 ")):v("",!0)]),e(f)?(l(),i("div",wt,[...s[15]||(s[15]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"正在获取每日早报...",-1)])])):e(c)?(l(),i("div",zt,[t("div",Ct,[t("img",{src:e(c).imageUrl,alt:e(c).title,loading:"lazy"},null,8,Mt)]),t("div",At,[t("h3",null,n(e(c).title),1),t("p",null,n(e(c).description),1),t("p",Tt,[t("span",null,"来源: "+n(e(c).source),1),t("span",null,"分类: "+n(e(c).category),1),t("span",null,"日期: "+n(e(c).datatime),1)])])])):e(k)?(l(),i("div",xt,[h(_,{name:"ph:warning-circle-bold",class:"error-icon"}),t("p",null,n(e(k)),1)])):v("",!0)])])],64)}}}),Et=U(Nt,[["__scopeId","data-v-399ca147"]]);export{Et as default};
